<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í™˜ìœ¨, ì‹œì°¨ ê³„ì‚°ê¸°</title>

  <!-- ëª¨ë°”ì¼ ì¤Œ ë°©ì§€ & ë°˜ì‘í˜• -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ì¹´ì¹´ì˜¤í†¡ / ë¯¸ë¦¬ë³´ê¸°ìš© ë©”íƒ€ -->
  <meta name="description" content="ê°„í¸í•˜ê²Œ í™˜ìœ¨,ì‹œì°¨ ê³„ì‚°í•˜ë ¤ë©´ ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ í™•ì¸í•˜ì„¸ìš”." />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="í™˜ìœ¨, ì‹œì°¨ ê³„ì‚°ê¸°" />
  <meta property="og:description" content="ê°„í¸í•˜ê²Œ í™˜ìœ¨,ì‹œì°¨ ê³„ì‚°í•˜ë ¤ë©´ ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ í™•ì¸í•˜ì„¸ìš”." />
  <meta property="og:url" content="https://eumditravel-oss.github.io/Exchange/" />
  <meta property="og:image" content="https://eumditravel-oss.github.io/Exchange/preview.png" />
  <meta property="og:locale" content="ko_KR" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="í™˜ìœ¨, ì‹œì°¨ ê³„ì‚°ê¸°" />
  <meta name="twitter:description" content="ê°„í¸í•˜ê²Œ í™˜ìœ¨,ì‹œì°¨ ê³„ì‚°í•˜ë ¤ë©´ ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ í™•ì¸í•˜ì„¸ìš”." />
  <meta name="twitter:image" content="https://eumditravel-oss.github.io/Exchange/preview.png" />

  <style>
    :root {
      --panel-bg: rgba(255, 255, 255, 0.78);
      --panel-inner-bg: rgba(255, 255, 255, 0.9);
      --border: rgba(209, 213, 219, 0.8);
      --accent: #2563eb;
      --accent-soft: rgba(37, 99, 235, 0.12);
      --text: #111827;
      --muted: #4b5563;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 16px 8px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text);
      background:
        linear-gradient(to bottom, rgba(15, 23, 42, 0.25), rgba(15, 23, 42, 0.3)),
        url("plane-window.png") center/cover fixed no-repeat;
    }

    .app {
      max-width: 1040px;
      margin: 0 auto;
      padding: 18px 20px 14px;
      background: var(--panel-bg);
      border-radius: 22px;
      border: 1px solid rgba(255, 255, 255, 0.6);
      box-shadow:
        0 16px 38px rgba(15, 23, 42, 0.32),
        0 0 0 1px rgba(255, 255, 255, 0.15);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }

    header {
      position: relative;
      z-index: 1;
    }

    /* ì œëª© */
    h1 {
      font-size: 1.45rem;
      margin: 0 0 0.15rem;
      color: #111827;
    }

    @media (max-width: 720px) {
      h1 { font-size: 1.25rem; }
    }

    p.desc {
      margin: 0;
      color: #374151;
      font-size: 0.9rem;
    }

    /* ìƒë‹¨ íƒ­ */
    .top-bar {
      margin-top: 10px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }

    .tabs {
      display: inline-flex;
      padding: 2px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.7);
      box-shadow: 0 1px 5px rgba(15, 23, 42, 0.18);
      gap: 4px;
    }

    .tab-button {
      border: none;
      background: transparent;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 0.86rem;
      cursor: pointer;
      color: #6b7280;
      white-space: nowrap;
    }

    .tab-button.active {
      background: #111827;
      color: #f9fafb;
    }

    .view {
      margin-top: 12px;
    }

    .layout {
      position: relative;
      z-index: 1;
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
    }

    .panel {
      flex: 1 1 320px;
      min-width: 0;
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 14px 16px 16px;
      background: var(--panel-inner-bg);
      box-shadow: 0 8px 24px rgba(15, 23, 42, 0.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* íŒ¨ë„ ìƒë‹¨ : ì œëª© + ì„ íƒë°©ì‹ */
    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .panel-header h2 {
      margin: 0;
      font-size: 1.05rem;
    }

    label {
      display: block;
      margin-top: 0.9rem;
      font-weight: 600;
      font-size: 0.88rem;
    }

    input, select, textarea {
      width: 100%;
      padding: 7px 9px;
      margin-top: 0.35rem;
      border: 1px solid rgba(148, 163, 184, 0.9);
      border-radius: 8px;
      font-size: 0.9rem;
      background: rgba(255, 255, 255, 0.92);
    }

    /* iPhoneì—ì„œ input í´ë¦­ ì‹œ í™•ëŒ€ ë°©ì§€ */
    @media (max-width: 720px) {
      input, select, textarea {
        font-size: 16px !important;
      }
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .help {
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 0.15rem;
    }

    .small-label {
      margin-top: 0.35rem;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .suggestions {
      position: relative;
    }

    .suggestions-list {
      position: absolute;
      z-index: 10;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.98);
      border: 1px solid rgba(209, 213, 219, 0.9);
      border-top: none;
      max-height: 200px;
      overflow-y: auto;
      font-size: 0.82rem;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.35);
    }

    .suggestion-item {
      padding: 6px 9px;
      cursor: pointer;
    }

    .suggestion-item:hover {
      background: var(--accent-soft);
    }

    .rate-info {
      margin-top: 0.45rem;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .error {
      margin-top: 0.5rem;
      color: #b91c1c;
      font-size: 0.8rem;
    }

    .ok {
      margin-top: 0.45rem;
      color: #2563eb;
      font-size: 0.8rem;
    }

    .calc-summary {
      margin-top: 0.7rem;
      font-size: 0.9rem;
    }

    .calc-summary div {
      margin-top: 0.25rem;
    }

    .calc-main {
      font-weight: 600;
    }

    .section-divider {
      margin-top: 0.9rem;
      padding-top: 0.7rem;
      border-top: 1px dashed rgba(148, 163, 184, 0.8);
    }

    .sub-heading {
      margin: 0 0 0.3rem;
      font-size: 0.9rem;
      font-weight: 600;
    }

    footer {
      position: relative;
      z-index: 1;
      margin-top: 12px;
      font-size: 0.78rem;
      color: #e5e7eb;
      text-align: center;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.35);
    }

    footer a {
      color: #bfdbfe;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* PC/ëª¨ë°”ì¼ ì„¤ëª… ë¶„ë¦¬ */
    .only-desktop { display: block; }
    .only-mobile  { display: none; }

    @media (max-width: 720px) {
      .panel { flex: 1 1 100%; }

      .top-bar {
        justify-content: flex-start;
      }

      .tab-button {
        padding: 4px 10px;
        font-size: 0.8rem;
      }

      .only-desktop { display: none; }
      .only-mobile  { display: block; }
    }

    /* í†µí™”/êµ­ê°€ ì„ íƒ ë°©ì‹ í† ê¸€ â€“ íŒ¨ë„ ìš°ì¸¡ ìƒë‹¨ */
    .mode-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 9px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 1px 4px rgba(15, 23, 42, 0.12);
      font-size: 0.78rem;
      color: #4b5563;
      white-space: nowrap;
    }

    .mode-label {
      font-weight: 500;
      font-size: 0.78rem;
    }

    .mode-btn {
      border: none;
      background: transparent;
      padding: 4px 9px;
      border-radius: 999px;
      font-size: 0.78rem;
      cursor: pointer;
      color: #6b7280;
      white-space: nowrap;
    }

    .mode-btn.active {
      background: #111827;
      color: #f9fafb;
    }

    @media (max-width: 720px) {
      .mode-toggle {
        font-size: 0.7rem;
        padding: 2px 6px;
        gap: 4px;
      }
      .mode-label {
        font-size: 0.7rem;
      }
      .mode-btn {
        padding: 3px 6px;
        font-size: 0.7rem;
      }
    }

    /* ì„ íƒ ë°©ì‹ì— ë”°ë¥¸ í‘œì‹œ ì œì–´ */
    body[data-pick-mode="search"] .select-mode { display: none; }
    body[data-pick-mode="search"] .search-mode { display: block; }

    body[data-pick-mode="select"] .select-mode { display: block; }
    body[data-pick-mode="select"] .search-mode { display: none; }

    /* í•©ì‚°ì‹ + / - í‚¤íŒ¨ë“œ */
    .calc-keypad-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 6px;
      font-size: 0.78rem;
    }

    .calc-keypad {
      display: inline-flex;
      gap: 6px;
    }

    .calc-key {
      min-width: 32px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: #f9fafb;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .calc-key:active { background: #e5e7eb; }

    .calc-hint {
      color: var(--muted);
      white-space: nowrap;
    }

    /* ===== ì¼ì • ê´€ë¦¬ íƒ­ ===== */
    .schedule-header-text {
      margin-top: 0.2rem;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .day-toolbar {
      margin-top: 0.85rem;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .day-toolbar button,
    .schedule-export-btn,
    .schedule-import-btn {
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: #f9fafb;
      font-size: 0.8rem;
      cursor: pointer;
    }

    .day-toolbar button.active-day {
      background: #111827;
      color: #f9fafb;
      border-color: #111827;
    }

    .day-tabs {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .day-tab-btn {
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: #ffffff;
      font-size: 0.78rem;
      cursor: pointer;
    }

    .day-tab-btn.active {
      background: #111827;
      color: #f9fafb;
      border-color: #111827;
    }

    .schedule-rows {
      margin-top: 6px;
    }

    /* í—¤ë”/í–‰ ê·¸ë¦¬ë“œ í­ â€“ êµ¬ê¸€ë§µ ë²„íŠ¼ í¬í•¨ */
    .schedule-table-header {
      display: grid;
      grid-template-columns: 70px minmax(120px, 2fr) minmax(120px, 2fr) 72px;
      gap: 6px;
      font-size: 0.8rem;
      color: var(--muted);
      margin-top: 12px;
    }

    .schedule-row {
      display: grid;
      grid-template-columns: 70px minmax(120px, 2fr) minmax(120px, 2fr) 72px;
      gap: 6px;
      margin-top: 6px;
      align-items: stretch;
    }

    .schedule-row input {
      width: 100%;
      padding: 6px 7px;
      font-size: 0.82rem;
      border: 1px solid rgba(148, 163, 184, 0.9);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.92);
      box-sizing: border-box;
    }

    .schedule-textarea {
      width: 100%;
      padding: 6px 7px;
      font-size: 0.82rem;
      border: 1px solid rgba(148, 163, 184, 0.9);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.92);
      box-sizing: border-box;
      resize: vertical;
      min-height: 32px;
      line-height: 1.3;
    }

    .map-btn {
      width: 100%;
      padding: 6px 0;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid rgba(37, 99, 235, 0.7);
      background: rgba(37, 99, 235, 0.06);
      color: #1d4ed8;
      cursor: pointer;
    }

    .add-row-btn {
      margin-top: 8px;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px dashed rgba(148, 163, 184, 0.9);
      background: #f9fafb;
      font-size: 0.8rem;
      cursor: pointer;
    }

    .schedule-footer {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .schedule-footer-note {
      margin-top: 8px;
      font-size: 0.78rem;
      color: var(--muted);
    }

    .schedule-export-area {
      margin-top: 8px;
      width: 100%;
      min-height: 80px;
      font-size: 0.8rem;
    }

    @media (max-width: 720px) {
      .schedule-table-header,
      .schedule-row {
        grid-template-columns: 60px minmax(100px, 2fr) minmax(100px, 2fr) 64px;
      }
    }
  </style>
</head>

<body data-pick-mode="search">
  <div class="app">
    <header>
      <h1>í™˜ìœ¨, ì‹œì°¨ ê³„ì‚°ê¸°</h1>
      <p class="desc">ì—¬í–‰Â·ì†¡ê¸ˆ ì „ì— í™˜ìœ¨, í™˜ì „ê¸ˆì•¡ í•©ì‚°, ì‹œì°¨, ì¼ì •ê¹Œì§€ í•œ ë²ˆì— í™•ì¸í•˜ê¸°.</p>

      <div class="top-bar">
        <div class="tabs">
          <button class="tab-button active" data-view="exchange">í™˜ìœ¨ ê³„ì‚°</button>
          <button class="tab-button" data-view="time">ì‹œì°¨ ê²€ìƒ‰</button>
          <button class="tab-button" data-view="schedule">ì¼ì • ê´€ë¦¬</button>
        </div>
      </div>
    </header>

    <!-- ===== í™˜ìœ¨ ê³„ì‚° ë·° ===== -->
    <div class="view view-exchange">
      <div class="layout">
        <section class="panel">
          <div class="panel-header">
            <h2>í™˜ìœ¨ ê³„ì‚°</h2>
            <div class="mode-toggle">
              <span class="mode-label">ì„ íƒ ë°©ì‹</span>
              <button class="mode-btn active" data-mode="search">ê²€ìƒ‰í˜•</button>
              <button class="mode-btn" data-mode="select">ë“œë¡­ë‹¤ìš´í˜•</button>
            </div>
          </div>

          <!-- ê¸°ì¤€ í†µí™” -->
          <label for="fromSearch">ê¸°ì¤€ í†µí™” (From)</label>
          <div class="search-mode">
            <div class="suggestions">
              <input id="fromSearch" type="text" placeholder="ì˜ˆ: hkd, í™ì½©, usd, ë¯¸êµ­â€¦" autocomplete="off" />
              <div id="fromSuggestions" class="suggestions-list" style="display:none;"></div>
            </div>
          </div>
          <div class="select-mode">
            <select id="fromSelect"></select>
          </div>
          <div class="small-label" id="fromSelectedLabel">ì„ íƒëœ ê¸°ì¤€ í†µí™”: í™ì½© ë‹¬ëŸ¬ (HKD)</div>

          <!-- ë³€í™˜ í†µí™” -->
          <label for="toSearch" style="margin-top:0.8rem;">ë³€í™˜ í†µí™” (To)</label>
          <div class="search-mode">
            <div class="suggestions">
              <input id="toSearch" type="text" placeholder="ì˜ˆ: krw, ì›, usd, eurâ€¦" autocomplete="off" />
              <div id="toSuggestions" class="suggestions-list" style="display:none;"></div>
            </div>
          </div>
          <div class="select-mode">
            <select id="toSelect"></select>
          </div>
          <div class="small-label" id="toSelectedLabel">ì„ íƒëœ ë³€í™˜ í†µí™”: ëŒ€í•œë¯¼êµ­ ì› (KRW)</div>

          <!-- í™˜ìœ¨ ì •ë³´ -->
          <div class="rate-info" id="rateInfo"></div>
          <div class="error" id="mainError"></div>
          <div class="ok" id="mainInfo"></div>

          <!-- í…ìŠ¤íŠ¸ í•©ì‚°ì‹ ì„¹ì…˜ -->
          <div class="section-divider">
            <p class="sub-heading">í…ìŠ¤íŠ¸ í•©ì‚°ì‹ ê³„ì‚°</p>
            <p class="help only-desktop">
              ì˜ˆ: <code>10+50-3</code> ì²˜ëŸ¼ ê³„ì‚°í•˜ë©´ ì´ í•©ì˜ í™˜ì „ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
            <p class="help only-mobile">
              ì˜ˆ: <code>10+50-3</code> ì²˜ëŸ¼ ì…ë ¥í•˜ë©´ í•©ê³„ì™€ í™˜ì „ ê°’ì„ í•œ ë²ˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>

            <label for="calcExpr" style="margin-top:0.5rem;">í•©ì‚°í•  ì‹ (ê¸°ì¤€ í†µí™” ê¸°ì¤€)</label>
            <input
              id="calcExpr"
              type="text"
              inputmode="numeric"
              pattern="[0-9+\\-\\s.,]*"
              placeholder="ì˜ˆ: 10+50-3"
            />

            <!-- + / - í‚¤íŒ¨ë“œ + ì•ˆë‚´ ë¬¸êµ¬ -->
            <div class="calc-keypad-row">
              <div class="calc-keypad">
                <button type="button" class="calc-key" data-op="+">+</button>
                <button type="button" class="calc-key" data-op="-">âˆ’</button>
              </div>
              <span class="calc-hint">(+,-ë¥¼ ëˆŒëŸ¬ í•©ì‚° ë˜ëŠ” ë¹¼ê¸° ê°€ëŠ¥í•©ë‹ˆë‹¤.)</span>
            </div>

            <div class="calc-summary">
              <div class="calc-main">
                í•©ê³„: <span id="calcSum">0</span> <span id="calcSumCurrency">HKD</span>
              </div>
              <div>
                í™˜ì „ ê¸ˆì•¡: <span id="calcConverted">-</span>
              </div>
              <div class="help">
                * ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ëŠ” í†µí™”ëŠ” ìœ„ì— ì„ íƒëœ <b>í†µí™”</b>ì™€ ë™ì¼í•©ë‹ˆë‹¤.
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>

    <!-- ===== ì‹œì°¨ ê²€ìƒ‰ ë·° ===== -->
    <div class="view view-time" style="display:none;">
      <div class="layout">
        <section class="panel">
          <div class="panel-header">
            <h2>ì‹œì°¨ ê²€ìƒ‰</h2>
            <div class="mode-toggle">
              <span class="mode-label">ì„ íƒ ë°©ì‹</span>
              <button class="mode-btn active" data-mode="search">ê²€ìƒ‰í˜•</button>
              <button class="mode-btn" data-mode="select">ë“œë¡­ë‹¤ìš´í˜•</button>
            </div>
          </div>

          <p class="help only-desktop">
            í•œêµ­(ì„œìš¸) ê¸°ì¤€ìœ¼ë¡œ ì„ íƒí•œ êµ­ê°€ì˜ í˜„ì¬ ì‹œê°„ê³¼ ì‹œì°¨ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </p>
          <p class="help only-mobile">
            í•œêµ­ ê¸°ì¤€ í˜„ì¬ ì‹œê°„ê³¼ ì„ íƒí•œ ë‚˜ë¼ì˜ ì‹œê°„, ì‹œì°¨ë¥¼ í•œ ë²ˆì— ë³´ì—¬ì¤ë‹ˆë‹¤.
          </p>

          <label for="timeSearch">ë‚˜ë¼ / í†µí™” ê²€ìƒ‰</label>

          <div class="search-mode">
            <div class="suggestions">
              <input id="timeSearch" type="text" placeholder="ì˜ˆ: ë¯¸êµ­, í™ì½©, ì¼ë³¸, usdâ€¦" autocomplete="off" />
              <div id="timeSuggestions" class="suggestions-list" style="display:none;"></div>
            </div>
          </div>
          <div class="select-mode">
            <select id="timeSelect"></select>
          </div>

          <div class="small-label" id="timeSelectedLabel">
            ì„ íƒëœ êµ­ê°€: í™ì½© (HKD, Asia/Hong_Kong)
          </div>

          <div class="calc-summary" style="margin-top: 0.9rem;">
            <div id="timeKorea" class="calc-main"></div>
            <div id="timeTarget" style="margin-top:0.35rem;"></div>
            <div id="timeDiff" class="help" style="margin-top:0.7rem;"></div>
          </div>
        </section>
      </div>
    </div>

    <!-- ===== ì¼ì • ê´€ë¦¬ ë·° ===== -->
    <div class="view view-schedule" style="display:none;">
      <div class="layout">
        <section class="panel">
          <div class="panel-header">
            <h2>ì¼ì • ê´€ë¦¬</h2>
          </div>

          <p class="schedule-header-text">
            ì—¬í–‰ ì „ì²´ íƒ€ì´í‹€ì„ ì…ë ¥í•˜ê³  Day ë‹¨ìœ„ë¡œ ì‹œê°„/ì¥ì†Œ/ë©”ëª¨ë¥¼ ì •ë¦¬í•˜ì„¸ìš”. ê° í–‰ì˜
            <b>ğŸ“ ë²„íŠ¼</b>ì„ ëˆ„ë¥´ë©´ ìë™ìœ¼ë¡œ êµ¬ê¸€ë§µ ê²€ìƒ‰ì´ ë©ë‹ˆë‹¤.
          </p>

          <label for="tripTitle">ì—¬í–‰ íƒ€ì´í‹€ / ë°©ë¬¸ êµ­ê°€</label>
          <input id="tripTitle" type="text" placeholder="ì˜ˆ: í™ì½©, ì˜¤ì‚¬ì¹´, ìœ ëŸ½ ì—¬í–‰" />

          <!-- Day ê´€ë¦¬ ë²„íŠ¼ -->
          <div class="day-toolbar">
            <button type="button" id="addDayBtn">Day ì¶”ê°€</button>
            <button type="button" id="deleteDayBtn">í˜„ì¬ Day ì‚­ì œ</button>
            <button type="button" id="renameDayBtn">í˜„ì¬ Day ì´ë¦„ ë³€ê²½</button>
          </div>

          <!-- Day íƒ­ -->
          <div class="day-tabs" id="dayTabs"></div>

          <!-- ì¼ì • í—¤ë” -->
          <div class="schedule-table-header">
            <div>ì‹œê°„</div>
            <div>ì§€ëª…</div>
            <div>ë¹„ê³ </div>
            <div>ğŸ“</div>
          </div>

          <!-- ì¼ì • í–‰ -->
          <div class="schedule-rows" id="scheduleRows"></div>

          <button type="button" class="add-row-btn" id="addRowBtn">+ ì¼ì • ì¶”ê°€</button>

          <!-- ë‚´ë³´ë‚´ê¸° / ë¶ˆëŸ¬ì˜¤ê¸° -->
          <div class="schedule-footer">
            <button type="button" class="schedule-export-btn" id="exportBtn">í…ìŠ¤íŠ¸ë¡œ ë‚´ë³´ë‚´ê¸°</button>
            <button type="button" class="schedule-import-btn" id="importBtn">í…ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°</button>
          </div>

          <textarea
            id="exportTextArea"
            class="schedule-export-area"
            placeholder="[Title] í™ì½© ì—¬í–‰
[Day.1]
09:00 | ì¹¨ì‚¬ì¶”ì´ ìŠ¤íƒ€ì˜ ê±°ë¦¬ | ì•¼ê²½ ê°ìƒ"
          ></textarea>

          <p class="schedule-footer-note">
            â€» í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ ì €ì¥í•´ ë‘ì—ˆë‹¤ê°€ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ ì´ì–´ì„œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </p>

          <!-- ìˆ¨ê²¨ì§„ íŒŒì¼ ì…ë ¥ (ë¶ˆëŸ¬ì˜¤ê¸°ìš©) -->
          <input type="file" id="importFileInput" accept=".txt" style="display:none;" />
        </section>
      </div>
    </div>

    <footer>
      GitHub Pages + JavaScript ì˜ˆì œ Â· í™˜ìœ¨ ë°ì´í„° ì œê³µ :
      <a href="https://www.exchangerate-api.com" target="_blank" rel="noopener noreferrer">ExchangeRate-API</a>
    </footer>
  </div>

  <script>
    // ===== í†µí™” + ì‹œê°„ëŒ€ ëª©ë¡ (countryKo í¬í•¨) =====
    const currencies = [
      { code: "USD", nameKo: "ë¯¸êµ­ ë‹¬ëŸ¬",     countryKo: "ë¯¸êµ­",       aliases: ["usd","dollar","ë‹¬ëŸ¬","ë¯¸êµ­","usa"], timeZone: "America/New_York" },
      { code: "EUR", nameKo: "ìœ ë¡œ",          countryKo: "ìœ ë¡œì¡´",     aliases: ["eur","euro","ìœ ë¡œ","ìœ ëŸ½"],        timeZone: "Europe/Berlin" },
      { code: "KRW", nameKo: "ëŒ€í•œë¯¼êµ­ ì›",   countryKo: "ëŒ€í•œë¯¼êµ­",   aliases: ["krw","ì›","í•œêµ­","ëŒ€í•œë¯¼êµ­","won","seoul"], timeZone: "Asia/Seoul" },
      { code: "HKD", nameKo: "í™ì½© ë‹¬ëŸ¬",     countryKo: "í™ì½©",       aliases: ["hkd","í™ì½©","hongkong","hong kong"], timeZone: "Asia/Hong_Kong" },
      { code: "JPY", nameKo: "ì¼ë³¸ ì—”",       countryKo: "ì¼ë³¸",       aliases: ["jpy","ì—”","ì—”í™”","ì¼ë³¸","japan","yen"], timeZone: "Asia/Tokyo" },
      { code: "CNY", nameKo: "ì¤‘êµ­ ìœ„ì•ˆ",     countryKo: "ì¤‘êµ­",       aliases: ["cny","ìœ„ì•ˆ","rmb","ì¤‘êµ­","china","yuan"], timeZone: "Asia/Shanghai" },
      { code: "GBP", nameKo: "ì˜êµ­ íŒŒìš´ë“œ",   countryKo: "ì˜êµ­",       aliases: ["gbp","íŒŒìš´ë“œ","ì˜êµ­","uk","london"], timeZone: "Europe/London" },
      { code: "AUD", nameKo: "í˜¸ì£¼ ë‹¬ëŸ¬",     countryKo: "í˜¸ì£¼",       aliases: ["aud","í˜¸ì£¼","australia","sydney"], timeZone: "Australia/Sydney" },
      { code: "CAD", nameKo: "ìºë‚˜ë‹¤ ë‹¬ëŸ¬",   countryKo: "ìºë‚˜ë‹¤",     aliases: ["cad","ìºë‚˜ë‹¤","canada","toronto"], timeZone: "America/Toronto" },
      { code: "CHF", nameKo: "ìŠ¤ìœ„ìŠ¤ í”„ë‘",   countryKo: "ìŠ¤ìœ„ìŠ¤",     aliases: ["chf","ìŠ¤ìœ„ìŠ¤","swiss","franc"], timeZone: "Europe/Zurich" },
      { code: "SGD", nameKo: "ì‹±ê°€í¬ë¥´ ë‹¬ëŸ¬", countryKo: "ì‹±ê°€í¬ë¥´",   aliases: ["sgd","ì‹±ê°€í¬ë¥´","singapore"], timeZone: "Asia/Singapore" },
      { code: "THB", nameKo: "íƒœêµ­ ë°”íŠ¸",     countryKo: "íƒœêµ­",       aliases: ["thb","íƒœêµ­","ë°©ì½•","thailand"], timeZone: "Asia/Bangkok" },
      { code: "TWD", nameKo: "ëŒ€ë§Œ ë‹¬ëŸ¬",     countryKo: "ëŒ€ë§Œ",       aliases: ["twd","ëŒ€ë§Œ","taiwan"], timeZone: "Asia/Taipei" },
      { code: "NZD", nameKo: "ë‰´ì§ˆëœë“œ ë‹¬ëŸ¬", countryKo: "ë‰´ì§ˆëœë“œ",   aliases: ["nzd","ë‰´ì§ˆëœë“œ","new zealand"], timeZone: "Pacific/Auckland" },
      { code: "PHP", nameKo: "í•„ë¦¬í•€ í˜ì†Œ",   countryKo: "í•„ë¦¬í•€",     aliases: ["php","í•„ë¦¬í•€","philippines"], timeZone: "Asia/Manila" },
      { code: "MYR", nameKo: "ë§ë ˆì´ì‹œì•„ ë§ê¹ƒ", countryKo: "ë§ë ˆì´ì‹œì•„", aliases: ["myr","ë§ë ˆì´ì‹œì•„","malaysia"], timeZone: "Asia/Kuala_Lumpur" },
      { code: "IDR", nameKo: "ì¸ë„ë„¤ì‹œì•„ ë£¨í”¼ì•„", countryKo: "ì¸ë„ë„¤ì‹œì•„", aliases: ["idr","ì¸ë„ë„¤ì‹œì•„","indonesia"], timeZone: "Asia/Jakarta" },
      { code: "VND", nameKo: "ë² íŠ¸ë‚¨ ë™",     countryKo: "ë² íŠ¸ë‚¨",     aliases: ["vnd","ë² íŠ¸ë‚¨","vietnam","ë™"], timeZone: "Asia/Ho_Chi_Minh" }
    ];

    // ===== DOM: í™˜ìœ¨ ë¶€ë¶„ =====
    const fromSearchInput = document.getElementById("fromSearch");
    const toSearchInput   = document.getElementById("toSearch");
    const fromSugBox      = document.getElementById("fromSuggestions");
    const toSugBox        = document.getElementById("toSuggestions");
    const fromLabel       = document.getElementById("fromSelectedLabel");
    const toLabel         = document.getElementById("toSelectedLabel");

    const fromSelect      = document.getElementById("fromSelect");
    const toSelect        = document.getElementById("toSelect");

    const rateInfoEl      = document.getElementById("rateInfo");
    const mainErrorEl     = document.getElementById("mainError");
    const mainInfoEl      = document.getElementById("mainInfo");

    const calcExprInput   = document.getElementById("calcExpr");
    const calcSumEl       = document.getElementById("calcSum");
    const calcSumCurrencyEl = document.getElementById("calcSumCurrency");
    const calcConvertedEl = document.getElementById("calcConverted");

    // ===== í•©ì‚°ì‹ìš© + / - ë²„íŠ¼ =====
    const calcKeyButtons = document.querySelectorAll(".calc-key");

    calcKeyButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const op = btn.dataset.op; // "+" ë˜ëŠ” "-"
        const input = calcExprInput;
        const start = input.selectionStart ?? input.value.length;
        const end   = input.selectionEnd ?? input.value.length;
        const before = input.value.slice(0, start);
        const after  = input.value.slice(end);
        input.value = before + op + after;
        const newPos = start + 1;
        input.focus();
        input.setSelectionRange(newPos, newPos);
        updateCalcResult();
      });
    });

    // ===== DOM: ì‹œì°¨ ë¶€ë¶„ =====
    const timeSearchInput = document.getElementById("timeSearch");
    const timeSugBox      = document.getElementById("timeSuggestions");
    const timeSelect      = document.getElementById("timeSelect");
    const timeLabel       = document.getElementById("timeSelectedLabel");
    const timeKoreaEl     = document.getElementById("timeKorea");
    const timeTargetEl    = document.getElementById("timeTarget");
    const timeDiffEl      = document.getElementById("timeDiff");

    // ===== DOM: ì¼ì • ë¶€ë¶„ =====
    const tripTitleInput   = document.getElementById("tripTitle");
    const dayTabsContainer = document.getElementById("dayTabs");
    const rowsContainer    = document.getElementById("scheduleRows");
    const addDayBtn        = document.getElementById("addDayBtn");
    const deleteDayBtn     = document.getElementById("deleteDayBtn");
    const renameDayBtn     = document.getElementById("renameDayBtn");
    const addRowBtn        = document.getElementById("addRowBtn");
    const exportBtn        = document.getElementById("exportBtn");
    const importBtn        = document.getElementById("importBtn");
    const exportTextArea   = document.getElementById("exportTextArea");
    const importFileInput  = document.getElementById("importFileInput");

    // ===== íƒ­ ì „í™˜ =====
    const tabButtons   = document.querySelectorAll(".tab-button");
    const viewExchange = document.querySelector(".view-exchange");
    const viewTime     = document.querySelector(".view-time");
    const viewSchedule = document.querySelector(".view-schedule");

    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        tabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const v = btn.dataset.view;
        viewExchange.style.display = (v === "exchange") ? "block" : "none";
        viewTime.style.display     = (v === "time")     ? "block"  : "none";
        viewSchedule.style.display = (v === "schedule") ? "block" : "none";
        if (v === "time") updateTimeInfo();
      });
    });

    // ===== ì„ íƒ ë°©ì‹ í† ê¸€ (í™˜ìœ¨/ì‹œì°¨ ê³µí†µ) =====
    const modeButtons = document.querySelectorAll(".mode-btn");

    function setPickMode(mode) {
      document.body.setAttribute("data-pick-mode", mode);
      modeButtons.forEach(b => {
        if (b.dataset.mode === mode) b.classList.add("active");
        else b.classList.remove("active");
      });
    }

    modeButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const mode = btn.dataset.mode;
        setPickMode(mode);
      });
    });

    // ===== ìƒíƒœ =====
    let baseCode   = "HKD"; // ê¸°ì¤€ í†µí™”
    let targetCode = "KRW"; // ë³€í™˜ í†µí™”
    let currentRate = null; // base â†’ target
    let lastUpdateText = "";

    let timeTargetCode = "HKD"; // ì‹œì°¨ ì¡°íšŒ ëŒ€ìƒ

    // ===== ê³µí†µ ìœ í‹¸ =====
    function findCurrency(code) {
      return currencies.find(c => c.code === code);
    }

    function formatCurrencyLabel(code) {
      const c = findCurrency(code);
      if (!c) return code;
      return `${c.nameKo} (${c.code})`;
    }

    function optionLabel(c) {
      return `${c.code} - ${c.nameKo}`;
    }

    function populateSelect(selectEl) {
      selectEl.innerHTML = "";
      currencies.forEach(c => {
        const opt = document.createElement("option");
        opt.value = c.code;
        opt.textContent = optionLabel(c);
        selectEl.appendChild(opt);
      });
    }

    function setSelectValue(selectEl, code) {
      const options = Array.from(selectEl.options);
      const found = options.find(o => o.value === code);
      if (found) selectEl.value = code;
    }

    function searchCurrencies(query) {
      const q = query.trim().toLowerCase();
      if (!q) return currencies.slice(0, 10);
      return currencies.filter(c => {
        const combined = (c.code + " " + c.nameKo + " " + c.aliases.join(" ")).toLowerCase();
        return combined.includes(q);
      }).slice(0, 10);
    }

    function setupSearchBox(inputEl, listEl, onSelect) {
      function renderList(items) {
        if (!items.length) {
          listEl.style.display = "none";
          listEl.innerHTML = "";
          return;
        }
        listEl.innerHTML = "";
        for (const c of items) {
          const div = document.createElement("div");
          div.className = "suggestion-item";
          div.textContent = optionLabel(c);
          div.addEventListener("mousedown", (e) => {
            e.preventDefault();
            inputEl.value = optionLabel(c);
            listEl.style.display = "none";
            onSelect(c.code);
          });
          listEl.appendChild(div);
        }
        listEl.style.display = "block";
      }

      inputEl.addEventListener("input", () => {
        renderList(searchCurrencies(inputEl.value));
      });

      inputEl.addEventListener("focus", () => {
        inputEl.value = "";
        renderList(searchCurrencies(""));
      });

      inputEl.addEventListener("blur", () => {
        setTimeout(() => { listEl.style.display = "none"; }, 150);
      });

      inputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          const items = searchCurrencies(inputEl.value);
          if (items.length > 0) {
            const c = items[0];
            inputEl.value = optionLabel(c);
            listEl.style.display = "none";
            onSelect(c.code);
          }
        }
      });
    }

    // ===== í™˜ìœ¨ API (open.er-api.com) =====
    async function fetchRate() {
      mainErrorEl.textContent = "";
      mainInfoEl.textContent = "";
      rateInfoEl.textContent = "";
      calcConvertedEl.textContent = "-";
      currentRate = null;

      try {
        const url = `https://open.er-api.com/v6/latest/${encodeURIComponent(baseCode)}`;
        const res = await fetch(url);
        if (!res.ok) {
          throw new Error("HTTP ì˜¤ë¥˜: " + res.status);
        }
        const data = await res.json();
        if (data.result !== "success") {
          throw new Error("API ì˜¤ë¥˜: " + (data["error-type"] || "unknown"));
        }

        const rate = data.rates?.[targetCode];
        if (typeof rate !== "number") {
          throw new Error("í•´ë‹¹ í†µí™” ìŒì˜ í™˜ìœ¨ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }

        currentRate = rate;
        lastUpdateText = data.time_last_update_utc || "";

        const baseStr = `1\u00a0${baseCode}`;
        const rateStr = `${rate.toLocaleString(undefined, { maximumFractionDigits: 4 })}\u00a0${targetCode}`;

        rateInfoEl.textContent =
          `${lastUpdateText || "ìµœê·¼"} ê¸°ì¤€ ${baseStr} â‰ˆ ${rateStr}`;
        mainInfoEl.textContent = "í™˜ìœ¨ ì •ë³´ë¥¼ ì •ìƒì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.";
        updateCalcResult();
      } catch (err) {
        console.error(err);
        mainErrorEl.textContent = "í™˜ìœ¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
      }
    }

    // "1000+5000-300" ê°™ì€ ì‹ íŒŒì‹±
    function parseExpression(raw) {
      const str = raw.replace(/,/g, "");
      if (!str.trim()) return 0;
      const tokens = str.match(/[+\-]?\s*\d+(?:\.\d+)?/g);
      if (!tokens) return NaN;
      let sum = 0;
      for (const t of tokens) {
        const num = Number(t.replace(/\s+/g, ""));
        if (!Number.isFinite(num)) return NaN;
        sum += num;
      }
      return sum;
    }

    function updateCalcResult() {
      const expr = calcExprInput.value;
      const sum = parseExpression(expr);
      if (Number.isNaN(sum)) {
        calcSumEl.textContent = "ì…ë ¥ ì˜¤ë¥˜";
        calcConvertedEl.textContent = "-";
        return;
      }
      calcSumEl.textContent = sum.toLocaleString();
      calcSumCurrencyEl.textContent = baseCode;

      if (!currentRate) {
        calcConvertedEl.textContent = "í™˜ìœ¨ ì •ë³´ë¥¼ ë¨¼ì € ë¶ˆëŸ¬ì™€ì•¼ í•©ë‹ˆë‹¤.";
        return;
      }
      const converted = sum * currentRate;
      calcConvertedEl.textContent =
        `${converted.toLocaleString(undefined, { maximumFractionDigits: 2 })} ${targetCode}`;
    }

    function setBase(code) {
      baseCode = code;
      fromLabel.textContent = `ì„ íƒëœ ê¸°ì¤€ í†µí™”: ${formatCurrencyLabel(code)}`;
      calcSumCurrencyEl.textContent = baseCode;
      setSelectValue(fromSelect, code);
      fetchRate();
    }

    function setTarget(code) {
      targetCode = code;
      toLabel.textContent = `ì„ íƒëœ ë³€í™˜ í†µí™”: ${formatCurrencyLabel(code)}`;
      setSelectValue(toSelect, code);
      fetchRate();
    }

    // ê²€ìƒ‰ ë°•ìŠ¤ ì„¸íŒ…
    setupSearchBox(fromSearchInput, fromSugBox, setBase);
    setupSearchBox(toSearchInput, toSugBox, setTarget);

    // select ë°•ìŠ¤ ì„¸íŒ…
    populateSelect(fromSelect);
    populateSelect(toSelect);

    fromSelect.addEventListener("change", () => setBase(fromSelect.value));
    toSelect.addEventListener("change", () => setTarget(toSelect.value));

    // ì´ˆê¸° ê°’ ì„¤ì • (í™˜ìœ¨)
    fromSearchInput.value = optionLabel(findCurrency("HKD"));
    toSearchInput.value   = optionLabel(findCurrency("KRW"));
    fromLabel.textContent = "ì„ íƒëœ ê¸°ì¤€ í†µí™”: í™ì½© ë‹¬ëŸ¬ (HKD)";
    toLabel.textContent   = "ì„ íƒëœ ë³€í™˜ í†µí™”: ëŒ€í•œë¯¼êµ­ ì› (KRW)";
    calcSumCurrencyEl.textContent = baseCode;
    setSelectValue(fromSelect, "HKD");
    setSelectValue(toSelect, "KRW");

    calcExprInput.addEventListener("input", updateCalcResult);

    // ===== ì‹œì°¨ ê³„ì‚° =====
    function formatLocalTime(date, timeZone) {
      return new Intl.DateTimeFormat("ko-KR", {
        timeZone,
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        weekday: "short",
        hour: "2-digit",
        minute: "2-digit"
      }).format(date);
    }

    function getOffsetMinutes(timeZone, date) {
      const fmt = new Intl.DateTimeFormat("en-US", {
        timeZone,
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        hour12: false
      });
      const parts = fmt.formatToParts(date);
      const map = {};
      for (const p of parts) map[p.type] = p.value;
      const asUTC = Date.UTC(
        Number(map.year),
        Number(map.month) - 1,
        Number(map.day),
        Number(map.hour),
        Number(map.minute),
        Number(map.second)
      );
      const diffMs = asUTC - date.getTime();
      return diffMs / 60000; // ë¶„
    }

    function describeDiff(diffMin, countryName) {
      if (Math.abs(diffMin) < 0.5) {
        return `${countryName}ì€(ëŠ”) í•œêµ­ê³¼ ì‹œì°¨ê°€ ì—†ìŠµë‹ˆë‹¤.`;
      }
      const ahead = diffMin > 0;
      const abs = Math.round(Math.abs(diffMin));
      const hours = Math.floor(abs / 60);
      const minutes = abs % 60;
      let parts = [];
      if (hours) parts.push(`${hours}ì‹œê°„`);
      if (minutes) parts.push(`${minutes}ë¶„`);
      const span = parts.join(" ");
      return `${countryName}ì€(ëŠ”) í•œêµ­ë³´ë‹¤ ${span} ${ahead ? "ë¹ ë¦…ë‹ˆë‹¤" : "ëŠë¦½ë‹ˆë‹¤"}.`;
    }

    function updateTimeInfo() {
      const baseTZ = "Asia/Seoul";
      const now = new Date();

      const baseTimeStr = formatLocalTime(now, baseTZ);
      timeKoreaEl.textContent = `í•œêµ­ ì‹œê°„: ${baseTimeStr}`;

      const c = findCurrency(timeTargetCode);
      if (!c || !c.timeZone) {
        timeTargetEl.textContent = "ì„ íƒí•œ êµ­ê°€ì˜ ì‹œê°„ëŒ€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        timeDiffEl.textContent = "";
        return;
      }

      const country = c.countryKo || c.nameKo;
      const targetTimeStr = formatLocalTime(now, c.timeZone);
      timeTargetEl.textContent = `${country} ì‹œê°„: ${targetTimeStr}`;

      const baseOffset = getOffsetMinutes(baseTZ, now);
      const targetOffset = getOffsetMinutes(c.timeZone, now);
      const diffMin = targetOffset - baseOffset;
      timeDiffEl.textContent = describeDiff(diffMin, country);
    }

    function setTimeTarget(code) {
      timeTargetCode = code;
      const c = findCurrency(code);
      if (c) {
        const country = c.countryKo || c.nameKo;
        timeLabel.textContent =
          `ì„ íƒëœ êµ­ê°€: ${country} (${c.code}, ${c.timeZone || "ì‹œê°„ëŒ€ ì •ë³´ ì—†ìŒ"})`;
      } else {
        timeLabel.textContent = `ì„ íƒëœ êµ­ê°€ ì½”ë“œ: ${code}`;
      }
      setSelectValue(timeSelect, code);
      updateTimeInfo();
    }

    setupSearchBox(timeSearchInput, timeSugBox, setTimeTarget);
    populateSelect(timeSelect);
    timeSelect.addEventListener("change", () => setTimeTarget(timeSelect.value));

    // ì´ˆê¸° ê°’ ì„¤ì • (ì‹œì°¨: í™ì½©)
    timeSearchInput.value = optionLabel(findCurrency("HKD"));
    setSelectValue(timeSelect, "HKD");
    setTimeTarget("HKD");

    // ===== ì¼ì • ê´€ë¦¬ ë¡œì§ =====
    let scheduleDays = [
      { name: "Day.1", rows: [] }
    ];
    let currentDayIndex = 0;

    function renderDayTabs() {
      dayTabsContainer.innerHTML = "";
      scheduleDays.forEach((day, idx) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "day-tab-btn" + (idx === currentDayIndex ? " active" : "");
        btn.textContent = day.name;
        btn.addEventListener("click", () => {
          currentDayIndex = idx;
          renderDayTabs();
          renderRows();
        });
        dayTabsContainer.appendChild(btn);
      });
    }

    function renderRows() {
      rowsContainer.innerHTML = "";
      const day = scheduleDays[currentDayIndex];

      day.rows.forEach((row, idx) => {
        const div = document.createElement("div");
        div.className = "schedule-row";

        // ì‹œê°„
        const timeInput = document.createElement("input");
        timeInput.placeholder = "ì˜ˆ: 09:00";
        timeInput.value = row.time || "";
        timeInput.addEventListener("input", () => {
          row.time = timeInput.value;
        });

        // ì§€ëª…
        const placeTextarea = document.createElement("textarea");
        placeTextarea.className = "schedule-textarea";
        placeTextarea.placeholder = "ì˜ˆ: ì¹¨ì‚¬ì¶”ì´ ìŠ¤íƒ€ì˜ ê±°ë¦¬";
        placeTextarea.value = row.place || "";
        placeTextarea.addEventListener("input", () => {
          row.place = placeTextarea.value;
        });

        // ë¹„ê³ 
        const noteTextarea = document.createElement("textarea");
        noteTextarea.className = "schedule-textarea";
        noteTextarea.placeholder = "ì˜ˆ: ì•¼ê²½ ê°ìƒ";
        noteTextarea.value = row.note || "";
        noteTextarea.addEventListener("input", () => {
          row.note = noteTextarea.value;
        });

        // êµ¬ê¸€ë§µ ë²„íŠ¼
        const mapBtn = document.createElement("button");
        mapBtn.type = "button";
        mapBtn.className = "map-btn";
        mapBtn.textContent = "ğŸ“";
        mapBtn.title = "êµ¬ê¸€ë§µ ì—´ê¸°";
        mapBtn.setAttribute("aria-label", "êµ¬ê¸€ë§µ ì—´ê¸°");

        mapBtn.addEventListener("click", () => {
          const title = tripTitleInput.value.trim();
          const place = placeTextarea.value.trim();
          const queryParts = [];
          if (title) queryParts.push(title);
          if (place) queryParts.push(place);
          if (!queryParts.length) return;
          const url =
            "https://www.google.com/maps/search/?api=1&query=" +
            encodeURIComponent(queryParts.join(" "));
          window.open(url, "_blank");
        });

        div.appendChild(timeInput);
        div.appendChild(placeTextarea);
        div.appendChild(noteTextarea);
        div.appendChild(mapBtn);

        rowsContainer.appendChild(div);
      });
    }

    function addRow() {
      const day = scheduleDays[currentDayIndex];
      day.rows.push({ time: "", place: "", note: "" });
      renderRows();
    }

    function addDay() {
      const newIndex = scheduleDays.length + 1;
      scheduleDays.push({ name: `Day.${newIndex}`, rows: [] });
      currentDayIndex = scheduleDays.length - 1;
      renderDayTabs();
      renderRows();
    }

    function deleteCurrentDay() {
      if (scheduleDays.length === 1) {
        alert("ìµœì†Œ 1ê°œì˜ DayëŠ” ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.");
        return;
      }
      if (!confirm("í˜„ì¬ Dayë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
      scheduleDays.splice(currentDayIndex, 1);
      if (currentDayIndex >= scheduleDays.length) {
        currentDayIndex = scheduleDays.length - 1;
      }
      renderDayTabs();
      renderRows();
    }

    function renameCurrentDay() {
      const day = scheduleDays[currentDayIndex];
      const newName = prompt("í˜„ì¬ Day ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.", day.name);
      if (!newName) return;
      day.name = newName;
      renderDayTabs();
    }

    function buildExportText() {
      const lines = [];
      const title = tripTitleInput.value.trim();
      if (title) {
        lines.push(`[Title] ${title}`);
      }
      scheduleDays.forEach(day => {
        lines.push(`\n[${day.name}]`);
        day.rows.forEach(row => {
          const time = (row.time || "").replace(/\n/g, " ");
          const place = (row.place || "").replace(/\n/g, " ");
          const note = (row.note || "").replace(/\n/g, " ");
          if (!time && !place && !note) return;
          lines.push(`${time} | ${place} | ${note}`);
        });
      });
      return lines.join("\n");
    }

    function exportToFile() {
      const text = buildExportText();
      exportTextArea.value = text;

      const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "travel-plan.txt";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function parseImportText(text) {
      const lines = text.split(/\r?\n/);
      const newDays = [];
      let currentDay = null;

      lines.forEach(rawLine => {
        const line = rawLine.trim();
        if (!line) return;

        if (line.startsWith("[Title]")) {
          const title = line.replace("[Title]", "").trim();
          tripTitleInput.value = title;
          return;
        }

        const dayMatch = line.match(/^\[(Day\.\d+.*)\]$/);
        if (dayMatch) {
          currentDay = { name: dayMatch[1], rows: [] };
          newDays.push(currentDay);
          return;
        }

        if (!currentDay) return;
        const parts = line.split("|").map(p => p.trim());
        const time = parts[0] || "";
        const place = parts[1] || "";
        const note = parts[2] || "";
        currentDay.rows.push({ time, place, note });
      });

      if (newDays.length === 0) {
        alert("ë¶ˆëŸ¬ì˜¬ Day ì •ë³´ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
        return;
      }

      scheduleDays = newDays;
      currentDayIndex = 0;
      renderDayTabs();
      renderRows();
    }

    function handleImportFile(files) {
      if (!files || !files.length) return;
      const file = files[0];
      const reader = new FileReader();
      reader.onload = (e) => {
        const text = e.target.result || "";
        exportTextArea.value = text;
        parseImportText(text);
      };
      reader.readAsText(file, "utf-8");
    }

    // ì¼ì • ì´ë²¤íŠ¸ ì—°ê²°
    addRowBtn.addEventListener("click", addRow);
    addDayBtn.addEventListener("click", addDay);
    deleteDayBtn.addEventListener("click", deleteCurrentDay);
    renameDayBtn.addEventListener("click", renameCurrentDay);
    exportBtn.addEventListener("click", exportToFile);
    importBtn.addEventListener("click", () => importFileInput.click());
    importFileInput.addEventListener("change", () => handleImportFile(importFileInput.files));

    // ì´ˆê¸° ë Œë”ë§
    renderDayTabs();
    renderRows();

    // ì‹œì‘ ì‹œ í™˜ìœ¨ í•œë²ˆ ê°€ì ¸ì˜¤ê¸° & ê¸°ë³¸ ì„ íƒ ë°©ì‹
    fetchRate();
    setPickMode("search");
  </script>
</body>
</html>